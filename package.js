"use strict";!function(scope){scope.module={exports:{}},scope.modules={},scope.modulesCached={},scope.modulesPath={wabi:"../../wabi/index.js"},scope.process?scope.process.env={NODE_ENV:"dev"}:scope.process={env:{NODE_ENV:"dev"}},scope._inherits=function(a,b){var protoA=a.prototype,proto=Object.create(b.prototype);for(var key in protoA){var param=Object.getOwnPropertyDescriptor(protoA,key);param.get||param.set?Object.defineProperty(proto,key,param):proto[key]=protoA[key]}a.prototype=proto,a.prototype.constructor=a,a.__parent=b,void 0===b.__inherit&&(b.__inherit={}),b.__inherit[a.name]=a;for(var parent=b.__parent;parent;)parent.__inherit[a.name]=a,parent=parent.__parent}}(window||global),function(){modules[2]={VNode:function(id,type,props,element,parent){this.id=id,this.type=type,this.props=props,this.element=element,this.parent=parent,this.prevElement=null,this.children=[],this.index=0,this.component=null}}}(),function(){var VNode=modules[2].VNode;const stack=new Array(128);let stackIndex=0,bodyNode=null,prevMountedElement=null;const elementOpen=function(type,props,srcElement){const parent=stack[stackIndex];let node=parent.children[parent.index];if(node){if(node.type!==type){const element=srcElement||document.createElement(type);if(node.component){node.component.remove(),node.component=null;const children=node.children;for(let n=0;n<children.length;n++)element.appendChild(children[n].element)}else{const prevElement=node.element;for(;prevElement.firstChild;)element.appendChild(prevElement.firstChild);prevElement.parentElement.replaceChild(element,prevElement)}if(props){for(let key in props)setProp(element,key,props[key]);node.props=props}node.id=parent.index,node.type=type,node.element=element}else{const element=node.element,prevProps=node.props;if(props!==prevProps)if(props){if(prevProps){for(let key in prevProps)void 0===props[key]&&unsetProp(element,key);for(let key in props){const value=props[key];value!==prevProps[key]&&setProp(element,key,value)}}else for(let key in props)setProp(element,key,props[key]);node.props=props}else if(prevProps){for(let key in prevProps)unsetProp(element,key);node.props=null}}prevMountedElement?(node.prevElement=prevMountedElement,prevMountedElement=null):node.prevElement=null}else{const element=srcElement||document.createElement(type);if(node=new VNode(parent.index,type,props,element,parent),prevMountedElement&&(node.prevElement=prevMountedElement,prevMountedElement=null),props)for(let key in props)setProp(element,key,props[key]);parent.children[parent.index]=node}return parent.index++,stackIndex++,stack[stackIndex]=node,node},elementClose=function(type){const node=stack[stackIndex];if(node.type!==type&&console.error("(Element.close) Unexpected element closed: "+type+" but was expecting: "+node.type),node.index!==node.children.length&&removeUnusedNodes(node),node.index=0,!node.element.parentElement){const parent=stack[stackIndex-1];node.prevElement?parent.element.insertBefore(node.element,node.prevElement.nextSibling):parent.element.appendChild(node.element)}stackIndex--,prevMountedElement=node.element},componentVoid=function(componentCls,props){const parent=stack[stackIndex];let node=parent.children[parent.index];if(!node)return createComponent(componentCls,parent,node,props);{const component=node.component;if(!component)return createComponent(componentCls,parent,node,props);if(component.constructor!==componentCls)component.remove(),createComponent(componentCls,parent,node,props);else{const prevProps=node.props;if(props!==prevProps)if(props){if(prevProps){for(let key in prevProps)void 0===props[key]&&("$"===key[0]?component[key]=component.state[key.slice(1)]:component[key]=null);for(let key in props){const value=props[key];component[key]!==value&&(component[key]=value)}}else for(let key in props)component[key]=props[key];node.props=props}else if(prevProps){for(let key in prevProps)"$"===key[0]?component[key]=component.state[ket.slice(1)]:component[key]=null;node.props=null}component.dirty?(parent.index++,stack[++stackIndex]=node,component.render(),component.index=0,component.dirty=!1,node.index!==node.children.length&&removeUnusedNodes(node),node.index=0,stackIndex--):parent.index++}}return node.component},createComponent=function(componentCls,parent,node,props){const component=new componentCls;if(props)for(let key in props)component[key]=props[key];component.mount&&component.mount();let vnode;return node?node.component?(vnode=node).index=0:((vnode=new VNode(0,null,props,parent.element,parent)).children.push(node),vnode.id=node.id,node.parent.children[node.id]=vnode,node.id=0,node.index=0,node.parent=vnode):(vnode=new VNode(0,null,props,parent.element,parent),parent.children.push(vnode)),vnode.component=component,vnode.prevElement=prevMountedElement,parent.index++,stackIndex++,stack[stackIndex]=vnode,component.vnode=vnode,component.depth=stackIndex,component.render(),component.dirty=!1,vnode.index!==vnode.children.length&&removeUnusedNodes(vnode),vnode.index=0,stackIndex--,component},setProp=function(element,name,value){if("class"===name)element.className=value;else if("style"===name)if("object"==typeof value){const elementStyle=element.style;for(let key in value)elementStyle[key]=value[key]}else element.style.cssText=value;else"o"===name[0]&&"n"===name[1]?element[name]=value:element.setAttribute(name,value)},unsetProp=function(element,name){"class"===name?element.className="":"style"===name?element.style.cssText="":"o"===name[0]&&"n"===name[1]?element[name]=null:element.removeAttribute(name)},removeUnusedNodes=function(node){const children=node.children;for(let n=node.index;n<children.length;n++){const child=children[n];removeNode(child)}children.length=node.index},removeNode=function(node){node.component?node.component.remove():node.element.parentElement&&node.element.parentElement.removeChild(node.element);const children=node.children;for(let n=0;n<children.length;n++){const child=children[n];removeNode(child)}node.children.length=0};modules[5]={elementOpen:elementOpen,elementClose:elementClose,elementVoid:function(type,props){const node=elementOpen(type,props);return elementClose(type),node},element:function(element,props){const node=elementOpen(element.localName,props,element);return elementClose(element.localName),node},componentVoid:componentVoid,text:function(txt){const parent=stack[stackIndex];let node=parent.children[parent.index];if(node)if("#text"!==node.type){const element=document.createTextNode(txt);node.type="#text",node.component?(node.component.remove(),node.component=null,node.prevElement?parent.element.insertBefore(element,node.prevElement.nextSibling):parent.element.appendChild(element)):node.element.parentElement.replaceChild(element,node.element),node.element=element,removeUnusedNodes(node)}else node.element.nodeValue!==txt&&(node.element.nodeValue=txt);else{const element=document.createTextNode(txt),node=new VNode(parent.index,"#text",null,element,parent,null);parent.children[parent.index]=node,parent.element.appendChild(element)}return parent.index++,node},render:function(component,parentElement){bodyNode||(bodyNode=new VNode(0,"body",null,parentElement,null)),stackIndex=0,stack[0]=bodyNode,componentVoid(component),bodyNode.index!==bodyNode.children.length&&removeUnusedNodes(bodyNode),bodyNode.index=0},renderInstance:function(instance){const vnode=instance.vnode;stackIndex=instance.depth,stack[instance.depth]=vnode,prevMountedElement=vnode.prevElement,instance.render(),instance.dirty=!1,vnode.index!==vnode.children.length&&removeUnusedNodes(vnode),vnode.index=0},removeAll:function(){removeUnusedNodes(bodyNode)}}}(),function(){function Route(regexp,component,enterFunc,exitFunc,readyFunc){this.regexp=regexp,this.component=component,this.enterFunc=enterFunc||null,this.exitFunc=exitFunc||null,this.readyFunc=readyFunc||null}modules[2].VNode;var __module5=modules[5],render=__module5.render,renderInstance=__module5.renderInstance,removeAll=__module5.removeAll;const updateBuffer=[],routes=[];let needUpdate=!1,needUpdateRoute=!1,currRouteResult=[],currRoute=null,url=null;const renderLoop=function(){needUpdate&&updateRender(),needUpdateRoute&&updateRoute(),window.requestAnimationFrame(renderLoop)},updateRender=function(){updateBuffer.sort(sortByDepth);for(let n=0;n<updateBuffer.length;n++){const node=updateBuffer[n];node.dirty&&renderInstance(node)}updateBuffer.length=0,needUpdate=!1},sortByDepth=function(a,b){return a.depth-b.depth},updateRoute=function(){(url=document.location.hash)||(url="/"),currRouteResult.length=0;let result;for(let n=0;n<routes.length;n++){const routeItem=routes[n];if(routeItem.regexp){const regex=new RegExp(routeItem.regexp,"g");for(;result=regex.exec(url);)currRouteResult.push(result);if(0===currRouteResult.length)continue}if(currRoute===routeItem)break;currRoute&&currRoute.exitFunc&&currRoute.exitFunc(),(currRoute=routeItem).enterFunc&&currRoute.enterFunc(currRouteResult),render(currRoute.component,document.body),currRoute.readyFunc&&currRoute.readyFunc();break}currRoute||console.warn("Could not found route for: "+url),needUpdateRoute=!1};window.addEventListener("hashchange",()=>{updateRoute()}),renderLoop(),modules[4]={update:function(instance){instance.dirty||(instance.dirty=!0,updateBuffer.push(instance),needUpdate=!0)},route:function(regexp,component,enterFunc,exitFunc,readyFunc){routes.push(new Route(regexp,component,enterFunc,exitFunc,readyFunc)),needUpdateRoute=!0},clearRoutes:function(remove){routes.length=0,currRoute=null,remove&&removeAll()}}}(),function(){function Proxy(key,func){this.key=key,this.func=func}function WatcherBuffer(){this.funcs=[],this.buffer=null}function Store(){this.data={},this.proxies=[],this.emitting=!1,this.watchers=new WatcherBuffer,this.watchers.buffer={}}modules[4].update;Store.prototype={set:function(key,value){this.dispatch({action:"SET",key:key,value:value})},add:function(key,value){this.dispatch({action:"ADD",key:key,value:value})},remove:function(key,value){this.dispatch({action:"REMOVE",key:key,value:value})},dispatch:function(data){this.globalProxy?this.globalProxy(data):this.handle(data)},performSet:function(payload){const tuple=this.getData(payload.key);tuple&&(payload.key?(tuple.data[tuple.key]=payload.value,this.emit({action:"SET",key:tuple.parentKey,value:tuple.data},tuple.watchers,"SET",tuple.key,payload.value)):(this.data=payload.value,this.emitWatchers({action:"SET",key:"",value:payload.value},this.watchers)))},performAdd:function(payload){const tuple=this.getData(payload.key);if(!tuple)return;let array=tuple.data[tuple.key];if(array){if(!Array.isArray(array))return void console.warn("(store) Data at key '${payload.key}' is not an Array");array.push(payload.value)}else array=[payload.value],tuple.data[tuple.key]=array;const funcs=tuple.watchers.funcs;if(funcs){const payloadSet={action:"SET",key:tuple.key,value:tuple.data};for(let n=0;n<funcs.length;n++)funcs[n](payloadSet);const watchers=tuple.watchers.buffer[tuple.key];if(watchers){const funcs=watchers.funcs;if(funcs){payloadSet.value=array;for(let n=0;n<funcs.length;n++)funcs[n](payloadSet)}}}},performRemove:function(payload){const tuple=this.getData(payload.key);if(!tuple)return;const data=payload.value?tuple.data[tuple.key]:tuple.data;if(Array.isArray(data)){if(void 0!==payload.value){const index=data.indexOf(payload.value);if(-1===index)return;return data.splice(index,1),void this.emitWatchers({action:"SET",key:tuple.key,value:data},tuple.watchers.buffer[tuple.key])}data.splice(parseInt(tuple.key),1)}else{if(void 0!==payload.value)return delete data[payload.value],void this.emitWatchers({action:"REMOVE",key:payload.value},tuple.watchers.buffer[tuple.key]);delete data[tuple.key]}this.emit({action:"SET",key:tuple.parentKey,value:tuple.data},tuple.watchers,"REMOVE",tuple.key,null)},handle:function(data){for(let n=0;n<this.proxies.length;n++){const proxy=this.proxies[n];if(0===data.key.indexOf(proxy.key)&&proxy.func(data))return}switch(data.action){case"SET":this.performSet(data);break;case"ADD":this.performAdd(data);break;case"REMOVE":this.performRemove(data)}},watch:function(path,func){if(!path)return;let watchers=this.watchers;const keys=path.split("/");for(let n=0;n<keys.length;n++){const key=keys[n],buffer=watchers.buffer;if(!buffer){watchers=this.fillWatchers(watchers,keys,n);break}{const nextWatchers=buffer[key];if(!nextWatchers){const newWatchers=new WatcherBuffer;watchers.buffer[key]=newWatchers,watchers=this.fillWatchers(newWatchers,keys,n+1);break}watchers=nextWatchers}}watchers.funcs.push(func)},fillWatchers:function(watchers,keys,index){for(let n=index;n<keys.length;n++){const newWatcher=new WatcherBuffer;watchers.buffer={},watchers.buffer[keys[n]]=newWatcher,watchers=newWatcher}return watchers},unwatch:function(path,func){if(!path)return;let watchers=this.watchers;const keys=path.split("/");for(let n=0;n<keys.length;n++){if(!watchers.buffer)return void console.warn("(store.unwatch) Watcher can not be found for:",path);if(!(watchers=watchers.buffer[keys[n]]))return}const funcs=watchers.funcs,index=funcs.indexOf(func);-1!==index?this.emitting?funcs.splice(index,1):(funcs[index]=funcs[funcs.length-1],funcs.pop()):console.warn("(store.unwatch) Watcher can not be found for:",path)},emit:function(payload,watchers,action,key,value){if(!watchers)return;this.emitting=!0;const funcs=watchers.funcs;if(funcs)for(let n=0;n<funcs.length;n++)funcs[n](payload);(watchers=watchers.buffer?watchers.buffer[key]:null)&&(payload.action=action,payload.key=key,payload.value=value,this.emitWatchers(payload,watchers)),this.emitting=!1},emitWatchers:function(payload,watchers){const funcs=watchers.funcs;if(funcs)for(let n=0;n<funcs.length;n++)funcs[n](payload);const buffer=watchers.buffer;if(buffer){const value=payload.value;if(value&&"object"==typeof value)for(let key in buffer)payload.key=key,payload.value=void 0===value[key]?null:value[key],this.emitWatchers(payload,buffer[key]);else{payload.value=null;for(let key in buffer)payload.key=key,this.emitWatchers(payload,buffer[key])}}},get:function(key){if(!key)return void 0===key?"":this.data;const buffer=key.split("/");let data=this.data;for(let n=0;n<buffer.length;n++){const id=buffer[n];if("@"===id)return buffer[n-1];if(void 0===(data=data[id]))return null}return data},getData:function(path){if(!path)return{data:this.data,key:null,parentKey:null,watchers:null};const keys=path.split("/"),num=keys.length-1;if(0===num)return{data:this.data,key:keys[0],parentKey:null,watchers:this.watchers};let data=this.data,watchers=this.watchers;for(let n=0;n<num;n++){const key=keys[n],newData=data[key];if(!newData)return console.warn("(store.getData) No data available with key: ["+keys[n]+"] with path: ["+path+"]"),null;data=newData,watchers&&(watchers=watchers.buffer?watchers.buffer[key]:null)}return{data:data,key:keys[num],parentKey:keys[num-1],watchers:watchers}},addProxy:function(key,func){if(""===key){if(this.globalProxy)return void console.warn("(wabi.proxy) There is already global proxy declared");this.globalProxy=func}else{for(let n=0;n<this.proxies.length;n++){const proxy=this.proxies[n];if(proxy.key===key&&proxy.func===func)return void console.warn("(wabi.proxy) There is already a proxy declared with key:",key)}const proxy=new Proxy(key,func);this.proxies.push(proxy)}},removeProxy:function(key,func){if(""===key){if(this.globalProxy!==func)return void console.warn("(wabi.proxy) Global proxy functions don`t match");this.globalProxy=null}else for(let n=0;n<this.proxies.length;n++){const proxy=this.proxies[n];if(proxy.key===key&&proxy.func===func)return this.proxies[n]=this.proxies[this.proxies.length-1],void this.proxies.pop()}},toJSON:function(){return this.data}};const store=new Store;modules[6]={store:store,lastSegment:function(str){const index=str.lastIndexOf("/");return-1===index?null:str.slice(index+1)}}}(),function(){function WabiComponentInternal(){this.bindFuncs={},this.vnode=null,this.dirty=!1;const currState={};for(let key in this.state)currState[key]=this.state[key];this.$=currState}var update=modules[4].update,store=modules[6].store;WabiComponentInternal.prototype={_bind:null,mount:null,unmount:null,render:null,state:{value:null},remove:function(){if(this.unmount&&this.unmount(),"string"==typeof this._bind)store.unwatch(this._bind,this.bindFuncs.value);else for(let key in this._bind)store.unwatch(this._bind[key],this.bindFuncs[key]);this.dirty=!1},handleAction:function(state,value){this.$[state]=value,update(this)},setState:function(key,value){if(this.$[key]!==value)if(this._bind)if("string"==typeof this._bind)"value"===key?store.set(this._bind,value,!0):(this.$[key]=value,update(this));else{const binding=this._bind[key];binding?store.set(binding,value,!0):(this.$[key]=value,update(this))}else this.$[key]=value,update(this)},set bind(value){const prevBind=this._bind;if(prevBind)if(value)if("string"==typeof prevBind){if(prevBind!==value){const func=this.bindFuncs.value;store.unwatch(prevBind,func),store.watch(value,func)}this.$.value=store.get(value)}else for(let key in prevBind){const bindPath=value[key];if(prevBind[key]!==bindPath){const func=this.bindFuncs[key];store.unwatch(prevBind[key],func),store.watch(bindPath,func)}this.$[key]=store.get(bindPath)}else if("string"==typeof prevBind)store.unwatch(prevBind,this.bindFuncs.value),this.$.value=this.state.value;else for(let key in prevBind)store.unwatch(prevBind[key],this.bindFuncs[key]),this.bindFuncs[key]=void 0,this.$[key]=this.state[key];else if("string"==typeof value){const func=payload=>{this.handleAction("value",payload.value)};this.bindFuncs.value=func,store.watch(value,func),this.$.value=store.get(value)}else for(let key in value){const bindValue=value[key];if(!bindValue)continue;const func=payload=>{this.handleAction(key,payload.value)};this.bindFuncs[key]=func,store.watch(bindValue,func),this.$[key]=store.get(bindValue)}this._bind=value,this.dirty=!0},get bind(){return this._bind},updateAll:function(){update(this);const children=this.vnode.children;for(let n=0;n<children.length;n++){const child=children[n];child.component&&update(child.component)}}};modules[3]={component:function(componentProto){function WabiComponent(){WabiComponentInternal.call(this)}const proto=Object.create(WabiComponentInternal.prototype);for(let key in componentProto){const param=Object.getOwnPropertyDescriptor(componentProto,key);param.get||param.set?Object.defineProperty(proto,key,param):proto[key]=componentProto[key]}const states=proto.state;for(let key in states)Object.defineProperty(proto,"$"+key,{set:function(value){this.setState(key,value)},get:function(){return this.$[key]}});return WabiComponent.prototype=proto,WabiComponent.prototype.constructor=WabiComponent,WabiComponent}}}(),modules[7]={lastSegment:function(str){const index=str.lastIndexOf(".");return-1===index?null:str.slice(index+1)},selectElementContents:function(node){const range=document.createRange();range.selectNodeContents(node);const selection=window.getSelection();selection.removeAllRanges(),selection.addRange(range)}},function(){var VNode=modules[2].VNode,component=modules[3].component,__module5=modules[5],elementOpen=__module5.elementOpen,elementClose=__module5.elementClose,elementVoid=__module5.elementVoid,element=__module5.element,componentVoid=__module5.componentVoid,text=__module5.text,render=__module5.render,__module4=modules[4],update=__module4.update,route=__module4.route,clearRoutes=__module4.clearRoutes,__module6=modules[6],store=__module6.store,lastSegment=__module6.lastSegment,__module7=modules[7],lastSegment=__module7.lastSegment,selectElementContents=__module7.selectElementContents;modules[1]={VNode:VNode,component:component,elementOpen:elementOpen,elementClose:elementClose,elementVoid:elementVoid,element:element,componentVoid:componentVoid,text:text,render:render,update:update,route:route,clearRoutes:clearRoutes,store:store,lastSegment:lastSegment,lastSegment:lastSegment,selectElementContents:selectElementContents}}(),function(){var __module1=modules[1],component=__module1.component,elementOpen=__module1.elementOpen,elementClose=__module1.elementClose,text=__module1.text,selectElementContents=__module1.selectElementContents;const Word=component({state:{value:null,editable:!0,editing:!1},mount:function(){this.attr={spellcheck:!1,onclick:this.handleClick.bind(this),ondblclick:this.handleDblClick.bind(this),onkeydown:this.handleKeyDown.bind(this),onblur:this.handleBlur.bind(this)}},render:function(){let attr;attr=this.$.editing?Object.assign({contentEditable:!0},this.attr):Object.assign({},this.attr);const node=elementOpen("word",attr);text(this.$.value),elementClose("word"),this.$.editing&&(node.element.focus(),selectElementContents(node.element))},handleClick:function(event){event.preventDefault(),event.detail%2||(event.stopPropagation(),this.$editable&&(this.$editing=!0))},handleDblClick:function(event){event.preventDefault(),event.stopPropagation()},handleKeyDown:function(domEvent){const keyCode=domEvent.keyCode;if(!(keyCode>47&&keyCode<58||keyCode>64&&keyCode<91||keyCode>96&&keyCode<123||95===keyCode||189===keyCode||190===keyCode||32===keyCode||8===keyCode||46==keyCode||keyCode>=37&&keyCode<=40)){if(27===keyCode)domEvent.target.blur();else if(13===keyCode)domEvent.target.blur();else if(35===keyCode||36===keyCode)return;domEvent.preventDefault()}},handleBlur:function(domEvent){const newValue=domEvent.target.innerHTML;newValue&&(this.$value=newValue),this.$editing=!1}});modules[9]=Word}(),function(){const cloneObj=function(obj){const result={};for(let key in obj){const value=obj[key];"object"==typeof obj[key]&&value?value instanceof Array?result[key]=value.slice(0):result[key]=cloneObj(value):result[key]=value}return result},rngBuffer=new Uint8Array(16),tempResult=new Array(16),byteToHex=new Array(256);for(let n=0;n<256;n++)byteToHex[n]=(n+256).toString(16).substr(1);modules[10]={isEmpty:function(obj){for(let key in obj)if(obj[key])return!1;return!0},dataURItoBlob:function(dataURI,type){const binary=atob(dataURI.split(",")[1]),length=binary.length,array=new Uint8Array(length);for(let n=0;n<length;n++)array[n]=binary.charCodeAt(n);return new Blob([array],{type:type})},cloneObj:cloneObj,uuid4:()=>{crypto.getRandomValues(rngBuffer),rngBuffer[6]=15&rngBuffer[6]|64,rngBuffer[8]=63&rngBuffer[8]|128;for(let n=0;n<16;n++)tempResult[n]=byteToHex[rngBuffer[n]];return tempResult.join("")}}}(),function(){var __module1=modules[1],component=__module1.component,componentVoid=__module1.componentVoid,elementOpen=__module1.elementOpen,elementClose=__module1.elementClose,elementVoid=__module1.elementVoid,text=__module1.text,Word=modules[9],isEmpty=modules[10].isEmpty;const HierarchyItem=component({state:{value:null,open:!1},mount:function(){this.attr={onclick:this.handleClick.bind(this)}},render:function(){this.$value;elementOpen("item",this.attr),this.$open?elementVoid("caret",{class:"fa fa-caret-down"}):elementVoid("caret",{class:"fa fa-caret-right"}),elementVoid("icon",{class:"fa fa-folder"}),componentVoid(Word,{bind:this.bind.value+"/name"}),elementClose("item")},handleClick:function(event){event.detail%2||(this.$open=!this.$open)}}),Hierarchy=component({mount:function(){this.attr={style:"flex: 240px;"}},render:function(){const items=this.$value;if(elementOpen("panel",this.attr),elementOpen("hierarchy"),elementOpen("header"),text("Hierarchy"),elementClose("header"),isEmpty(items))elementOpen("content",{class:"centered"}),text("No content is added"),elementClose("content");else{elementOpen("content");for(let n=0;n<items.length;n++){items[n];const itemPath=this.bind+"/"+n;componentVoid(HierarchyItem,{bind:{value:itemPath,open:itemPath+"/local/open"}})}elementClose("content")}elementClose("hierarchy"),elementClose("panel")}});modules[8]=Hierarchy}(),function(){var store=modules[1].store;const hide=()=>{store.set("contextmenu/show",!1)};store.set("contextmenu",{show:!1,x:0,y:0}),window.addEventListener("click",event=>{hide()}),window.addEventListener("contextmenu",event=>{event.preventDefault(),hide()})}(),function(){function AddItem(data){this.data=data}function RemoveItem(data){this.data=data}var store=modules[1].store;AddItem.prototype={execute:function(){store.add("hierarchy",this.data)},undo:function(){store.remove("hierarchy",this.data)}},RemoveItem.prototype={execute:function(){store.remove("hierarchy",this.data)},undo:function(){store.add("hierarchy",this.data)}},modules[15]={AddItem:AddItem,RemoveItem:RemoveItem}}(),function(){function History(){this.undos=[],this.redos=[]}History.prototype={clear:function(){this.undos.length=0,this.redos.length=0},execute:function(cmd){this.undos.push(cmd),this.redos.length=0,cmd.execute()},undo:function(){if(0===this.undos.length)return;const cmd=this.undos.pop();this.redos.push(cmd),cmd.undo()},redo:function(){if(0===this.redos.length)return;const cmd=this.redos.pop();this.undos.push(cmd),cmd.execute()}};const instance=new History;modules[17]=instance}(),function(){function Editor(){}var History=modules[17];Editor.prototype={execute:function(cmd){History.execute(cmd)}};const instance=new Editor;modules[16]=instance}(),function(){var Commands=modules[15],Editor=modules[16],uuid4=modules[10].uuid4;modules[14]={folder:()=>{const data={id:uuid4(),type:"Folder",name:"Folder",local:{}};Editor.execute(new Commands.AddItem(data))}}}(),function(){const HierarchyMenu=[{type:"category",name:"create",children:[{icon:"fa-folder",name:"Folder",func:modules[14].folder}]}];modules[13]=HierarchyMenu}(),function(){var __module1=modules[1],component=__module1.component,componentVoid=__module1.componentVoid,elementOpen=__module1.elementOpen,elementClose=__module1.elementClose,elementVoid=__module1.elementVoid,text=__module1.text,HierarchyMenu=modules[13];const ContextMenuInner=component({render:function(){elementOpen("inner");const items=this.$value;for(let n=0;n<items.length;n++){const item=items[n];"category"===item.type?this.renderCategory(item):"menu"===item.type?this.renderMenu(item):this.renderItem(item)}elementClose("inner")},renderItem:function(item){const attr=item.func?{onclick:item.func}:null;elementOpen("item",attr),item.icon&&elementVoid("icon",{class:"fa "+item.icon}),text(item.name),elementClose("item")},renderCategory:function(item){elementOpen("category"),elementOpen("header"),text(item.name),elementClose("header"),componentVoid(ContextMenuInner,{$value:item.children}),elementClose("category")},renderMenu:function(item){elementOpen("item"),text(item.name),elementVoid("caret",{class:"fa fa-caret-right"}),elementOpen("contextmenu"),componentVoid(ContextMenuInner,{$value:item.children}),elementClose("contextmenu"),elementClose("item")}}),ContextMenu=component({mount:function(){this.bind="contextmenu"},render:function(){this.$value.show&&(elementOpen("contextmenu",{style:{left:this.$value.x+"px",top:this.$value.y+"px"}}),componentVoid(ContextMenuInner,{$value:HierarchyMenu}),elementClose("contextmenu"))}});modules[11]=ContextMenu}(),function(){const context={isMAC:!1};navigator.platform.toUpperCase().indexOf("MAC"),modules[18]=context}(),function(){var __module1=modules[1],component=__module1.component,componentVoid=__module1.componentVoid,elementOpen=__module1.elementOpen,elementClose=__module1.elementClose,route=__module1.route,store=__module1.store,Hierarchy=modules[8],ContextMenu=modules[11],History=modules[17],Device=modules[18];const Layout=component({mount:function(){this.attr={oncontextmenu:function(event){console.log("here"),event.preventDefault(),event.stopPropagation(),store.set("contextmenu",{x:event.clientX,y:event.clientY,show:!0})}}},render:function(){elementOpen("layout",this.attr),elementOpen("row"),componentVoid(Hierarchy,{bind:"hierarchy"}),elementClose("row"),elementClose("layout"),elementOpen("overlay"),componentVoid(ContextMenu),elementClose("overlay")}}),handleKeyDown=event=>{switch(event.keyCode){case 90:(Device.isMAC?event.metaKey:event.ctrlKey)&&(event.shiftKey?History.redo():History.undo())}};modules[0]=function(){store.set("hierarchy",[{id:"item1",type:"Folder",name:"Folder 1",local:{}},{id:"item2",type:"Folder",name:"Folder 2",local:{open:!0}},{id:"item3",type:"Folder",name:"Folder 3",local:{}}]),route("/",Layout),window.store=store,window.addEventListener("keydown",handleKeyDown)}}();